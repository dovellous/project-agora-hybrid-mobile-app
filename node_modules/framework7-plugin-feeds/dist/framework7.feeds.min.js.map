{"version":3,"sources":["../src/framework7.feeds.js","../src/feeds-class.js"],"names":["Feeds","name","install","Framework7Class","this","Class","constructor","app","params","super","Utils","utils","$","request","feeds","defaults","extend","on","$el","el","length","view","onFeedsLinkClick","e","preventDefault","index","data","open","items","onRefresh","refreshFeed","views","get","main","url","opened","attachEvents","parents","detachEvents","off","f7Feeds","init","formatDate","date","call","d","Date","split","getMonth","getDate","getFullYear","parseData","fragment","window","DOMParser","parseFromString","channel","find","newData","title","children","text","link","description","replace","copyright","image","width","height","each","item","itemData","pubDate","formattedDate","guid","customItemFields","childEl","i","fieldName","fieldAttr","nodeName","getAttribute","push","loadFeed","refresh","emit","feedUrl","response","virtualList","replaceAllItems","vlParams","renderItem","renderVirtualListItem","html","create","renderList","ptr","done","trim","map","join","renderItemNavbar","openIn","pageBackLinkText","popupCloseLinkText","renderItemPopup","renderPopup","renderItemPage","renderPage","onOpen","type","itemEl","$openedItemEl","openedItemEl","openedIn","onOpened","onClose","destroyed","onClosed","openPopup","popupParams","content","popupOpen","popup","popupOpened","popupClose","popupClosed","routableModals","router","navigate","route","path","modal","openPage","pageHtml","pageBeforeIn","page","pageAfterIn","pageBeforeOut","pageAfterOut","close","back","once","nextTick","destroy","deleteProps","selector","pageInit","feedsEl","dataset","pageBeforeRemove"],"mappings":"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","file":"framework7.feeds.min.js","sourcesContent":["import FeedsClassConstructor from './feeds-class';\n\nlet Feeds;\n\nexport default {\n  name: 'feeds',\n  install() {\n    const Framework7 = this;\n    Feeds = FeedsClassConstructor(Framework7.Class);\n    Framework7.Feeds = Feeds;\n  },\n  params: {\n    feeds: {\n      openIn: 'page',\n      url: 'feed/',\n      routableModals: true,\n      view: null,\n      feedUrl: null,\n      formatDate: null,\n      customItemFields: [],\n      virtualList: false,\n      pageBackLinkText: 'Back',\n      popupCloseLinkText: 'Close',\n      renderList: null,\n      renderVirtualListItem: null,\n      renderItemPage: null,\n      renderItemPopup: null,\n    },\n  },\n  create() {\n    const app = this;\n    app.feeds = {\n      create(params) {\n        return new Feeds(app, params);\n      },\n      get(selector) {\n        if (selector instanceof Feeds) return selector;\n        const $el = app.$(selector);\n        if ($el.length > 0 && $el[0] && $el[0].f7Feeds) {\n          return $el[0].f7Feeds;\n        }\n        return undefined;\n      },\n      destroy(selector) {\n        if (selector instanceof Feeds) {\n          if (selector.destroy) selector.destroy();\n          return;\n        }\n        const $el = app.$(selector);\n        if (!$el.length) return;\n        if ($el[0] && $el[0].f7Feeds && $el[0].f7Feeds.destroy) {\n          $el[0].f7Feeds.destroy();\n        }\n      },\n    };\n  },\n  on: {\n    pageInit(page) {\n      const app = page.app;\n      const $ = app.$;\n      const Utils = app.utils;\n      page.$el.find('.feeds-init').each((feedsEl) => {\n        const $el = $(feedsEl);\n        app.feeds.create(Utils.extend(\n          { el: feedsEl },\n          $el.dataset()\n        ));\n      });\n    },\n    pageBeforeRemove(page) {\n      const app = page.app;\n      page.$el.find('.feeds-init').each((feedsEl) => {\n        app.feeds.destroy(feedsEl);\n      });\n    },\n  },\n};\n","export default function (Framework7Class) {\n  return class Feeds extends Framework7Class {\n    constructor(app, params) {\n      super(params, [app]);\n\n      const Utils = app.utils;\n      const $ = app.$;\n      const request = app.request;\n\n      const feeds = this;\n      feeds.app = app;\n\n      const defaults = Utils.extend({\n        on: {},\n      }, app.params.feeds);\n\n      feeds.params = Utils.extend(defaults, params);\n\n      const $el = $(feeds.params.el);\n      if (!$el.length) return feeds;\n\n      let view;\n      if (feeds.params.view) {\n        view = feeds.params.view;\n      } else {\n        view = app.views.get($el);\n      }\n      if (!view) view = app.views.main;\n\n      Utils.extend(feeds, {\n        app,\n        request,\n        $el,\n        el: $el[0],\n        view,\n        url: feeds.params.url,\n        data: {},\n        opened: false,\n      });\n\n\n      function onFeedsLinkClick(e) {\n        e.preventDefault();\n        const index = $(this).data('index');\n        feeds.open(feeds.data.items[index]);\n      }\n      function onRefresh() {\n        feeds.refreshFeed();\n      }\n\n      feeds.attachEvents = function attachEvents() {\n        feeds.$el.on('click', 'a.feeds-item-link', onFeedsLinkClick);\n        feeds.$el.parents('.ptr-content').on('ptr:refresh', onRefresh);\n      };\n      feeds.detachEvents = function detachEvents() {\n        feeds.$el.off('click', 'a.feeds-item-link', onFeedsLinkClick);\n        feeds.$el.parents('.ptr-content').off('ptr:refresh', onRefresh);\n      };\n\n      $el[0].f7Feeds = feeds;\n\n      feeds.init();\n\n      return feeds;\n    }\n    formatDate(date) {\n      const feeds = this;\n      if (feeds.params.formatDate) return feeds.params.formatDate.call(feeds, date);\n\n      const d = new Date(date);\n      const months = ('Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec').split(' ');\n      return `${months[d.getMonth(d)]} ${d.getDate(d)}, ${d.getFullYear()}`;\n    }\n    parseData(data) {\n      const feeds = this;\n      const $ = feeds.app.$;\n      const parser = new window.DOMParser();\n      const fragment = parser.parseFromString(data, 'text/xml');\n      const channel = $(fragment).find('rss > channel');\n      if (channel.length === 0) return {};\n      const newData = {\n        title: channel.children('title').text(),\n        link: channel.children('link').text(),\n        description: channel.children('description').text().replace('<![CDATA[', '').replace(']]>', ''),\n        copyright: channel.children('copyright').text(),\n        image: {\n          url: channel.children('image').children('url').text(),\n          title: channel.children('image').children('title').text(),\n          link: channel.children('image').children('link').text(),\n          width: channel.children('image').children('width').text(),\n          height: channel.children('image').children('height').text(),\n        },\n        items: [],\n      };\n      const items = channel.find('item');\n      items.each((el) => {\n        const item = $(el);\n        const itemData = {\n          title: item.children('title').text().replace('<![CDATA[', '').replace(']]>', ''),\n          link: item.children('link').text(),\n          description: item.children('description').text().replace('<![CDATA[', '').replace(']]>', ''),\n          pubDate: item.children('pubDate').text(),\n          formattedDate: feeds.formatDate(item.children('pubDate').text()),\n          guid: item.children('guid').text(),\n          index: newData.items.length,\n        };\n        if (feeds.params.customItemFields && feeds.params.customItemFields.length > 0) {\n          item.children().each((childEl) => {\n            for (let i = 0; i < feeds.params.customItemFields.length; i += 1) {\n              const fieldName = feeds.params.customItemFields[i].split('||')[0];\n              const fieldAttr = feeds.params.customItemFields[i].split('||')[1];\n              if (childEl.nodeName === fieldName) {\n                if (fieldAttr) itemData[fieldName.replace(/:/g, '')] = childEl.getAttribute(fieldAttr);\n                else itemData[fieldName.replace(/:/g, '')] = $(childEl).text().replace('<![CDATA[', '').replace(']]>', '');\n              }\n            }\n          });\n        }\n        newData.items.push(itemData);\n      });\n\n      return newData;\n    }\n    loadFeed(refresh) {\n      const feeds = this;\n      const app = feeds.app;\n      feeds.emit('local::ajaxStart feedsAjaxStart', feeds);\n      feeds.request.get(feeds.params.feedUrl, (response) => {\n        feeds.emit('local::ajaxComplete feedsAjaxComplete', feeds, response);\n        feeds.data = feeds.parseData(response);\n        if (feeds.params.virtualList) {\n          if (refresh) {\n            feeds.virtualList.replaceAllItems(feeds.data.items);\n          } else {\n            let vlParams;\n            if (feeds.params.virtualList === 'true' || feeds.params.virtualList === true) {\n              vlParams = {};\n            } else {\n              vlParams = app.utils.extend({}, feeds.params.virtualList);\n            }\n            vlParams.el = feeds.el;\n            vlParams.items = feeds.data.items;\n            vlParams.renderItem = feeds.renderVirtualListItem;\n            feeds.$el.html('');\n            feeds.virtualList = app.virtualList.create(vlParams);\n          }\n        } else {\n          feeds.$el.html(feeds.renderList(feeds.data));\n        }\n\n        // Reset PTR\n        if (refresh) app.ptr.done(feeds.$el.parents('.ptr-content'));\n      });\n    }\n    renderVirtualListItem(item, index) {\n      const feeds = this;\n      if (feeds.params.renderVirtualListItem) return feeds.params.renderVirtualListItem.call(feeds, item, index);\n\n      const itemHtml = `\n        <li>\n          <a href=\"#\" class=\"item-link item-content feeds-item-link\" data-index=\"${index}\">\n            <div class=\"item-inner\">\n              <div class=\"item-title\">${item.title}</div>\n              <div class=\"item-after\">${item.formattedDate}</div>\n            </div>\n          </a>\n        </li>\n      `;\n\n      return itemHtml.trim();\n    }\n    renderList(data) {\n      const feeds = this;\n      if (feeds.params.renderList) return feeds.params.renderList.call(feeds, data);\n\n      const listHtml = `\n        <ul>\n          ${data.items.map((item, index) => `\n            <li>\n              <a href=\"#\" class=\"item-link item-content feeds-item-link\" data-index=\"${index}\">\n                <div class=\"item-inner\">\n                  <div class=\"item-title\">${item.title}</div>\n                  <div class=\"item-after\">${item.formattedDate}</div>\n                </div>\n              </a>\n            </li>\n          `).join('')}\n        </ul>\n      `;\n      return listHtml.trim();\n    }\n    renderItemNavbar(item) {\n      const feeds = this;\n      if (feeds.params.renderItemNavbar) return feeds.params.renderItemNavbar.call(feeds, item);\n\n      const navbarHtml = `\n        <div class=\"navbar\">\n          <div class=\"navbar-inner sliding\">\n            ${feeds.params.openIn === 'page' ? `\n            <div class=\"left\">\n              <a href=\"#\" class=\"link back\">\n                <i class=\"icon icon-back\"></i>\n                <span class=\"ios-only\">${feeds.params.pageBackLinkText}</span>\n              </a>\n            </div>\n            ` : ''}\n            <div class=\"title\">${item.title}</div>\n            ${feeds.params.openIn === 'popup' ? `\n            <div class=\"right\">\n              <a href=\"#\" class=\"link popup-close\" data-popup=\".feeds-popup\">${feeds.params.popupCloseLinkText}</a>\n            </div>\n            ` : ''}\n          </div>\n        </div>\n      `;\n\n      return navbarHtml.trim();\n    }\n    renderItemPopup(item) {\n      const feeds = this;\n      if (feeds.params.renderPopup) return feeds.params.renderPopup.call(feeds, item);\n\n      const popupHtml = `\n        <div class=\"popup feeds-popup\">\n          <div class=\"view view-init\">\n            ${feeds.renderItemPage(item)}\n          </div>\n        </div>\n      `;\n\n      return popupHtml.trim();\n    }\n    renderItemPage(item) {\n      const feeds = this;\n      if (feeds.params.renderPage) return feeds.params.renderPage.call(feeds, item);\n\n      const pageHtml = `\n        <div class=\"page feeds-page\" data-page=\"feeds-page-${item.index}\">\n          ${feeds.renderItemNavbar(item)}\n          <div class=\"page-content\">\n            <div class=\"block\">\n              <a href=\"${item.link}\" class=\"external\" target=\"_blank\">${item.title}</a><br>\n              <small>${item.formattedDate}</small>\n            </div>\n            <div class=\"block block-strong\">${item.description}</div>\n          </div>\n        </div>\n      `;\n\n      return pageHtml.trim();\n    }\n    refreshFeed() {\n      const feeds = this;\n      return feeds.loadFeed(true);\n    }\n    onOpen(type, itemEl) {\n      const feeds = this;\n      const app = feeds.app;\n      const $openedItemEl = app.$(itemEl);\n      feeds.$openedItemEl = $openedItemEl;\n      feeds.openedItemEl = $openedItemEl[0];\n      feeds.openedIn = type;\n      feeds.opened = true;\n\n      feeds.emit('local::open feedsOpen', feeds);\n    }\n    onOpened() {\n      const feeds = this;\n      feeds.emit('local::opened feedsOpened', feeds);\n    }\n    onClose() {\n      const feeds = this;\n      if (feeds.destroyed) return;\n      feeds.emit('local::close feedsClose', feeds);\n    }\n    onClosed() {\n      const feeds = this;\n      if (feeds.destroyed) return;\n      feeds.opened = false;\n      feeds.$openedItemEl = null;\n      feeds.openedItemEl = null;\n      delete feeds.$openedItemEl;\n      delete feeds.openedItemEl;\n\n      feeds.emit('local::closed feedsClosed', feeds);\n    }\n    openPopup(item) {\n      const feeds = this;\n      if (feeds.opened) return feeds;\n      const popupHtml = feeds.renderItemPopup(item);\n      const popupParams = {\n        content: popupHtml,\n        on: {\n          popupOpen(popup) {\n            feeds.onOpen('popup', popup.el);\n          },\n          popupOpened(popup) {\n            feeds.onOpened('popup', popup.el);\n          },\n          popupClose(popup) {\n            feeds.onClose('popup', popup.el);\n          },\n          popupClosed(popup) {\n            feeds.onClosed('popup', popup.el);\n          },\n        },\n      };\n\n      if (feeds.params.routableModals) {\n        feeds.view.router.navigate({\n          url: feeds.url,\n          route: {\n            path: feeds.url,\n            popup: popupParams,\n          },\n        });\n      } else {\n        feeds.modal = feeds.app.popup.create(popupParams).open();\n      }\n      return feeds;\n    }\n    openPage(item) {\n      const feeds = this;\n      if (feeds.opened) return feeds;\n      const pageHtml = feeds.renderItemPage(item);\n      feeds.view.router.navigate({\n        url: feeds.url,\n        route: {\n          content: pageHtml,\n          path: feeds.url,\n          on: {\n            pageBeforeIn(e, page) {\n              feeds.onOpen('page', page.el);\n            },\n            pageAfterIn(e, page) {\n              feeds.onOpened('page', page.el);\n            },\n            pageBeforeOut(e, page) {\n              feeds.onClose('page', page.el);\n            },\n            pageAfterOut(e, page) {\n              feeds.onClosed('page', page.el);\n            },\n          },\n        },\n      });\n      return feeds;\n    }\n    open(item) {\n      const feeds = this;\n      if (feeds.opened) return feeds;\n      if (feeds.params.openIn === 'popup') {\n        return feeds.openPopup(item);\n      }\n      return feeds.openPage(item);\n    }\n    close() {\n      const feeds = this;\n      if (!feeds.opened) return feeds;\n      if (feeds.params.routableModals || feeds.openedIn === 'page') {\n        feeds.view.router.back();\n      } else {\n        feeds.modal.once('modalClosed', () => {\n          feeds.app.utils.nextTick(() => {\n            feeds.modal.destroy();\n            delete feeds.modal;\n          });\n        });\n        feeds.modal.close();\n      }\n      return feeds;\n    }\n\n    init() {\n      const feeds = this;\n      feeds.loadFeed();\n      feeds.attachEvents();\n    }\n    destroy() {\n      const feeds = this;\n      feeds.emit('local::beforeDestroy feedsBeforeDestroy', feeds);\n      feeds.detachEvents();\n\n      if (feeds.virtualList && feeds.virtualList.destroy) {\n        feeds.virtualList.destroy();\n      }\n\n      delete feeds.$el[0].f7Feeds;\n      feeds.app.utils.deleteProps(feeds);\n      feeds.destroyed = true;\n    }\n  };\n}\n"]}